@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title Entity Layer Dependencies


' Entity Layer (Domain Layer) - Center with no dependencies
Container_Boundary(entity_layer, "Entity Layer") {
  Component(entities, "Domain Models", "Pydantic", "Core business entities and rules")
  Component(repo_protocols, "Repository Protocols", "Python Protocol", "Interface contracts for data access")
  Component(request_response, "Request/Response Objects", "Pydantic", "API boundary contracts")
  Component(validation, "Domain Validation", "Runtime validation", "Security and contract enforcement")
}

' External components that depend on entities
Component(usecases, "Use Cases", "Application logic", "Business workflows and orchestration")
Component(controllers, "Controllers", "FastAPI", "Handle HTTP requests/responses")
Component(repo_impl, "Repository Implementations", "Concrete classes", "Database, file storage, etc.")

' Entity Layer internal dependencies
Rel_D(validation, entities, "validates")
Rel_D(validation, repo_protocols, "enforces contracts")
Rel_D(request_response, entities, "converts to/from")

' External dependencies on Entity Layer
Rel_D(usecases, entities, "uses")
Rel_D(usecases, repo_protocols, "depends on")
Rel_D(usecases, request_response, "accepts/returns")
Rel_D(usecases, validation, "validates with")

Rel_D(controllers, request_response, "converts")
Rel_U(repo_impl, repo_protocols, "implements")
Rel_U(repo_impl, entities, "persists/retrieves")

@enduml